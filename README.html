<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.2">
<meta name="author" content="Alvaro Sanchez-Mariscal">
<title>Ratpack 101</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove the comments around the @import statement below when using this as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
#map_canvas img,#map_canvas embed,#map_canvas object,.map_canvas img,.map_canvas embed,.map_canvas object{max-width:none!important}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
.antialiased,body{-webkit-font-smoothing:antialiased}
img{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{display:inline-block;color:rgba(0,0,0,.8);font-size:.75em;line-height:1.4;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:-.15em .15em 0 .15em;padding:.2em .6em .2em .5em;vertical-align:middle;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.05em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.spread{width:100%}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1{padding-right:.75em;font-weight:bold}
td.hdlist1,td.hdlist2{vertical-align:top}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none}
span.footnote,span.footnoteref{vertical-align:super;font-size:.875em}
span.footnote a,span.footnoteref a{text-decoration:none}
span.footnote a:active,span.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em;line-height:1.3;font-size:.875em;margin-left:1.2em;text-indent:-1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
h1,h2{letter-spacing:-.01em}
dt,th.tableblock,td.content{text-rendering:optimizeLegibility}
p,td.content{letter-spacing:-.01em}
p strong,td.content strong{letter-spacing:-.005em}
p,blockquote,dt,td.content{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img{page-break-inside:avoid}
thead{display:table-header-group}
img{max-width:100%!important}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.js"></script>
<script>document.addEventListener('DOMContentLoaded', prettyPrint)</script>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Ratpack 101</h1>
<div class="details">
<span id="author" class="author">Alvaro Sanchez-Mariscal</span><br>
<span id="email" class="email"><a href="mailto:alvaro.sanchezmariscal@gmail.com">alvaro.sanchezmariscal@gmail.com</a></span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_software_requirements">Software requirements</a></li>
<li><a href="#_acknowledgments">Acknowledgments</a></li>
<li><a href="#_hello_world_using_a_groovy_script_15_minutes">1. Hello World using a Groovy script (15 minutes)</a></li>
<li><a href="#_creating_ratpack_projects_with_lazybones_and_running_them_with_gradle_and_as_standalone_jar_10_minutes">2. Creating Ratpack projects with Lazybones and running them with Gradle and as standalone JAR (10 minutes)</a>
<ul class="sectlevel2">
<li><a href="#_examining_the_project_layout_5_minutes">2.1. Examining the project layout (5 minutes)</a></li>
<li><a href="#_generating_a_standalone_fat_jar_5_minutes">2.2. Generating a standalone fat JAR (5 minutes)</a></li>
</ul>
</li>
<li><a href="#_working_with_handlers_30_minutes">3. Working with handlers (30 minutes)</a>
<ul class="sectlevel2">
<li><a href="#_delegating_to_the_next_handler">3.1. Delegating to the next handler</a></li>
<li><a href="#_responding_to_a_specific_path">3.2. Responding to a specific path</a></li>
<li><a href="#_grouping_handlers_by_path">3.3. Grouping handlers by path</a></li>
</ul>
</li>
<li><a href="#_testing_ratpack_applications_with_spock_20_minutes">4. Testing Ratpack applications with Spock (20 minutes)</a>
<ul class="sectlevel2">
<li><a href="#_unit_testing">4.1. Unit testing</a></li>
<li><a href="#_functional_testing">4.2. Functional testing</a></li>
</ul>
</li>
<li><a href="#_working_with_the_context_20_minutes">5. Working with the context (20 minutes)</a></li>
<li><a href="#_using_ratpack_modules_with_google_guice_20_minutes">6. Using Ratpack modules with Google Guice (20 minutes)</a>
<ul class="sectlevel2">
<li><a href="#_rendering_json_with_jackson">6.1. Rendering JSON with Jackson</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<a href="https://github.com/alvarosanchez/ratpack-101"><img style="position: fixed; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/365986a132ccd6a44c23a9169022c0b5c890c387/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f7265645f6161303030302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"></a>
<div class="paragraph">
<p>Introductory workshop about <a href="http://ratpack.io">Ratpack</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_software_requirements">Software requirements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Make sure you have:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>JDK 8 (both in command line and in your IDE).</p>
</li>
<li>
<p>Git.</p>
</li>
<li>
<p>Gradle 2.6.</p>
</li>
<li>
<p>Groovy 2.4.1+ (on the command line)</p>
</li>
<li>
<p>Lazybones installed via <a href="http://gvmtool.net/">GVM</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You should have a similar output in your terminal:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ java -version
java version "1.8.0_25"
Java(TM) SE Runtime Environment (build 1.8.0_25-b17)
Java HotSpot(TM) 64-Bit Server VM (build 25.25-b02, mixed mode)

$ git --version
git version 2.3.2

$ gradle -v

------------------------------------------------------------
Gradle 2.6
------------------------------------------------------------

Build time:   2015-02-16 05:09:33 UTC
Build number: none
Revision:     586be72bf6e3df1ee7676d1f2a3afd9157341274

Groovy:       2.3.9
Ant:          Apache Ant(TM) version 1.9.3 compiled on December 23 2013
JVM:          1.8.0_25 (Oracle Corporation 25.25-b02)
OS:           Mac OS X 10.10.2 x86_64

$ groovy -v
Groovy Version: 2.4.3 JVM: 1.8.0_25 Vendor: Oracle Corporation OS: Mac OS X

$ lazybones help
Lazybones is a command-line based tool for creating basic software projects from templates.

Available commands:

    create         Creates a new project from a template.
    config         Displays general help, or help for a specific command.
    generate       Generates new files in the current project based on a sub-template.
    list           Lists the templates that are available for you to install.
    info           Displays information about a template, such as latest version, description, etc.
    help           Displays general help, or help for a specific command.</pre>
</div>
</div>
<div class="paragraph">
<p>Once done, you can clone this repo:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>git clone https://github.com/alvarosanchez/ratpack-101.git</pre>
</div>
</div>
<div class="paragraph">
<p>You will find each exercise&#8217;s template files on each <code>exNN</code> folder. Solution is always inside a <code>solution</code> folder.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_acknowledgments">Acknowledgments</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/reanag">Andrea Nagy</a> for her valuable feedback about this workshop.</p>
</li>
<li>
<p><a href="https://github.com/jetztgradnet">Wolfgang Schell</a> for improvements to this guide.</p>
</li>
<li>
<p><a href="https://github.com/aldrinm">Aldrin Misquitta</a> for the upgrade to Ratpack 1.0</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_hello_world_using_a_groovy_script_15_minutes">1. Hello World using a Groovy script (15 minutes)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The simplest way of creating a Ratpack application is using a Groovy script. Create a file named <code>ratpack.groovy</code> with the following content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">@Grab('org.slf4j:slf4j-simple:1.7.12')
@Grab('io.ratpack:ratpack-groovy:1.1.1')
import static ratpack.groovy.Groovy.ratpack

ratpack {
    handlers {
        get(":name") {
            render "Hello $pathTokens.name!"
        }
        get {
            render "Hello World!"
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>What you see there is the Groovy DSL for Ratpack. Those not yet familiar with it, can try to guess what it&#8217;s defined there: 2 handlers for HTTP GET requests. We will explore handlers later.</p>
</div>
<div class="paragraph">
<p>Now let&#8217;s run that. Go to your terminal and run:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ groovy ratpack.groovy</pre>
</div>
</div>
<div class="paragraph">
<p>The first time you run it, it might take a while for <a href="http://docs.groovy-lang.org/latest/html/documentation/grape.html">Grape</a> to resolve the dependencies.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can use the JVM parameter <code>-Dgroovy.grape.report.downloads=true</code> to get output information about dependencies resolution.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Once it has finished, you can point your browser to <a href="http://localhost:5050" class="bare">http://localhost:5050</a> or <a href="http://localhost:5050/GR8Conf" class="bare">http://localhost:5050/GR8Conf</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_ratpack_projects_with_lazybones_and_running_them_with_gradle_and_as_standalone_jar_10_minutes">2. Creating Ratpack projects with Lazybones and running them with Gradle and as standalone JAR (10 minutes)</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://github.com/pledbrook/lazybones">Lazybones</a> is a scaffolding tool to generate application skeletons for different projects, and it&#8217;s the recommended option for bootstrapping a Ratpack application.</p>
</div>
<div class="paragraph">
<p>Letâ€™s create a Ratpack project in the current directory:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>lazybones create ratpack .</pre>
</div>
</div>
<div class="paragraph">
<p>After that, you can run the application with Gradle:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./gradlew run</pre>
</div>
</div>
<div class="sect2">
<h3 id="_examining_the_project_layout_5_minutes">2.1. Examining the project layout (5 minutes)</h3>
<div class="paragraph">
<p>Once you have created the app, let&#8217;s have a look at it&#8217;s content:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>build.gradle</code> is the main Gradle build file.</p>
</li>
<li>
<p><code>src/main/groovy</code> is the package root for your Groovy classes (as in all Gradle/Maven applications).</p>
</li>
<li>
<p><code>src/ratpack</code> contains Ratpack specific artifacts. The most important one is <code>Ratpack.groovy</code> which contains the Ratpack DSL. If you take a look at it, you will find it similar to the script we created in the previous exercise.</p>
</li>
<li>
<p><code>src/test/groovy</code> will contain your Spock tests.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_generating_a_standalone_fat_jar_5_minutes">2.2. Generating a standalone fat JAR (5 minutes)</h3>
<div class="paragraph">
<p>The <code>build.gradle</code> file generated by Lazybones comes with the Shadow plugin preinstalled, which will allow you to generate a standalone fat JAR.</p>
</div>
<div class="paragraph">
<p>To do so:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>./gradlew shadowJar</pre>
</div>
</div>
<div class="paragraph">
<p>Then, you can run it by simply executing:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>java -jar build/libs/*-all.jar</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_working_with_handlers_30_minutes">3. Working with handlers (30 minutes)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Ratpack is built on top of <a href="http://netty.io/">Netty</a>, a non-blocking HTTP server. Once the Ratpack server is started, it will listen for incoming requests, and for each, will execute all the handlers defined in the handler chain.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Ratpack <strong>is not</strong> Servlet API-based, so don&#8217;t expect things <code>HttpServletRequest</code> or <code>HttpSession</code>. However, you can think of handlers as a mix of a Servlet and a Filter.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Handlers are functions composed in a handler chain. A handler can do one of the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Respond to the request.</p>
</li>
<li>
<p>Delegate to the next handler in the chain.</p>
</li>
<li>
<p>Insert more handlers in the chain and delegate to them.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each handler receives a <a href="http://ratpack.io/manual/current/api/ratpack/handling/Context.html"><code>Context</code></a> object to interact with the <code>request</code>/<code>response</code> objects, the chain, etc. All the methods of the <code>Context</code> are automatically available in your <code>Ratpack.groovy</code> DSL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ratpack {
    handlers {
        handler {
            response.send("Hello World") //Equivalent to context.response.send("Hello World")
        }
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Handlers are evaluated and executed in the order they are defined. Handlers without path specified should be placed at the bottom of the chain.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Using the skeleton provided, work in the <code>Ratpack.groovy</code> file to complete the following exercises.</p>
</div>
<div class="sect2">
<h3 id="_delegating_to_the_next_handler">3.1. Delegating to the next handler</h3>
<div class="paragraph">
<p>Define a handler that prints out (<code>println</code>) the requested path, and then delegates to the next handler.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p><a href="http://ratpack.io/manual/current/api/ratpack/http/Request.html" class="bare">http://ratpack.io/manual/current/api/ratpack/http/Request.html</a></p>
</li>
<li>
<p><a href="http://ratpack.io/manual/current/api/ratpack/http/Request.html#getPath--" class="bare">http://ratpack.io/manual/current/api/ratpack/http/Request.html#getPath--</a></p>
</li>
<li>
<p><a href="http://ratpack.io/manual/current/api/ratpack/handling/Context.html#next--" class="bare">http://ratpack.io/manual/current/api/ratpack/handling/Context.html#next--</a></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can test it by requesting some URL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">$ curl 0:5050/some/path</code></pre>
</div>
</div>
<div class="paragraph">
<p>And you should see <code>/some/path</code> in the server logs.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You will also see a 404 error, as there is no downstream handler defined yet. You can ignore it for the moment.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_responding_to_a_specific_path">3.2. Responding to a specific path</h3>
<div class="paragraph">
<p>Define a handler that renders <code>"bar"</code> when a request is sent to <code>/foo</code></p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p><a href="http://ratpack.io/manual/current/api/ratpack/groovy/handling/GroovyChain.html#handler-java.lang.String-groovy.lang.Closure-" class="bare">http://ratpack.io/manual/current/api/ratpack/groovy/handling/GroovyChain.html#handler-java.lang.String-groovy.lang.Closure-</a></p>
</li>
<li>
<p><a href="http://ratpack.io/manual/current/api/ratpack/handling/Context.html#render-java.lang.Object-" class="bare">http://ratpack.io/manual/current/api/ratpack/handling/Context.html#render-java.lang.Object-</a></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Then test it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">$ curl 0:5050/foo
bar</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_grouping_handlers_by_path">3.3. Grouping handlers by path</h3>
<div class="paragraph">
<p>Define the next handlers nested in the path <code>/api</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<a href="http://ratpack.io/manual/current/api/ratpack/groovy/handling/GroovyChain.html#prefix-java.lang.String-groovy.lang.Closure-" class="bare">http://ratpack.io/manual/current/api/ratpack/groovy/handling/GroovyChain.html#prefix-java.lang.String-groovy.lang.Closure-</a>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_group_handlers_by_http_method">3.3.1. Group handlers by HTTP method</h4>
<div class="paragraph">
<p>Define 2 handlers for the path <code>/api/methods</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the request is GET, the response is <code>GET /api/methods</code>.</p>
</li>
<li>
<p>If the request is POST, the response is <code>POST /api/methods</code>.</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p><a href="http://ratpack.io/manual/current/api/ratpack/groovy/handling/GroovyContext.html#byMethod-groovy.lang.Closure-" class="bare">http://ratpack.io/manual/current/api/ratpack/groovy/handling/GroovyContext.html#byMethod-groovy.lang.Closure-</a></p>
</li>
<li>
<p><a href="http://ratpack.io/manual/current/api/ratpack/groovy/handling/GroovyByMethodSpec.html#get-groovy.lang.Closure-" class="bare">http://ratpack.io/manual/current/api/ratpack/groovy/handling/GroovyByMethodSpec.html#get-groovy.lang.Closure-</a></p>
</li>
<li>
<p><a href="http://ratpack.io/manual/current/api/ratpack/groovy/handling/GroovyByMethodSpec.html#post-groovy.lang.Closure-" class="bare">http://ratpack.io/manual/current/api/ratpack/groovy/handling/GroovyByMethodSpec.html#post-groovy.lang.Closure-</a></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To test them:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">$ curl 0:5050/api/methods
GET /api/methods

$ curl -X POST 0:5050/api/methods
POST /api/methods</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_defining_variable_parts_in_the_path">3.3.2. Defining variable parts in the path</h4>
<div class="paragraph">
<p>Define a handler for the path <code>/api/&lt;USERNAME&gt;</code>, where <code>&lt;USERNAME&gt;</code> can be any String. The response must be <code>Hello, &lt;USERNAME&gt;</code></p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<a href="http://ratpack.io/manual/current/api/ratpack/handling/Context.html#getPathTokens--" class="bare">http://ratpack.io/manual/current/api/ratpack/handling/Context.html#getPathTokens--</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To test it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">$ curl 0:5050/api/alvaro.sanchez
Hello alvaro.sanchez</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_defining_handlers_in_it_s_own_class">3.3.3. Defining handlers in it&#8217;s own class</h4>
<div class="paragraph">
<p>For other than simple examples, it is often a good practice to define handlers in their own class under <code>src/groovy</code>.</p>
</div>
<div class="paragraph">
<p>Create a handler (implementing <code>Handler</code> interface) for the path <code>/api/now/</code> and respond with a <code>new Date()</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p><a href="http://ratpack.io/manual/current/api/ratpack/handling/Handler.html" class="bare">http://ratpack.io/manual/current/api/ratpack/handling/Handler.html</a></p>
</li>
<li>
<p><a href="http://ratpack.io/manual/current/api/ratpack/groovy/handling/GroovyChain.html#handler-java.lang.String-ratpack.handling.Handler-" class="bare">http://ratpack.io/manual/current/api/ratpack/groovy/handling/GroovyChain.html#handler-java.lang.String-ratpack.handling.Handler-</a></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To test it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">$ curl 0:5050/api/now
Thu Nov 26 17:55:44 CET 2015</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_testing_ratpack_applications_with_spock_20_minutes">4. Testing Ratpack applications with Spock (20 minutes)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Write the following tests as specified under <code>src/test/groovy</code>. To run them, you can just run <code>./gradlew clean test</code></p>
</div>
<div class="sect2">
<h3 id="_unit_testing">4.1. Unit testing</h3>
<div class="paragraph">
<p>Unit testing does not require any special infrastructure. Moreover, Ratpack helps you providing a <a href="http://ratpack.io/manual/current/api/ratpack/test/handling/RequestFixture.html"><code>RequestFixture</code></a> which can help you unit testing your handler.</p>
</div>
<div class="paragraph">
<p>It is particularly useful to have handlers in their own class, to be able to test them. For instance, you can use the following code to mock a JSON request to your handler, in a fluent API way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">HandlingResult result = RequestFixture.handle(new MyHandlerImpl()) { RequestFixture fixture -&gt;
    fixture.body('{"foo":"bar"}', 'application/json').header('X-Auth-Token', 'sdfgdsfgdsfgdfg')
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>There are other useful methods in <code>RequestFixture</code>, like <code>method()</code> to specify the HTTP method, <code>registry()</code> to set values on the registry if your handler expects them and <code>uri()</code> and <code>pathBinding()</code> to specify the URL and the parameters in the request.</p>
</div>
<div class="paragraph">
<p>Have a look at the <a href="http://ratpack.io/manual/current/api/ratpack/test/handling/RequestFixture.html">full documentation</a>.</p>
</div>
<div class="paragraph">
<p>The returned value is of type <a href="http://ratpack.io/manual/current/api/ratpack/test/handling/HandlingResult.html"><code>HandlingResult</code></a>, on which you can make assertions about the result of the execution of the handler.</p>
</div>
<div class="paragraph">
<p>So, given the <code>UsernameHandler</code> implementation, write a Spock unit test specification (<code>UsernameHandlerSpec</code>) that tests it with both empty and non-empty strings.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p><a href="http://ratpack.io/manual/current/api/ratpack/test/handling/RequestFixture.html#handle-ratpack.handling.Handler-ratpack.func.Action-" class="bare">http://ratpack.io/manual/current/api/ratpack/test/handling/RequestFixture.html#handle-ratpack.handling.Handler-ratpack.func.Action-</a></p>
</li>
<li>
<p><a href="http://ratpack.io/manual/current/api/ratpack/test/handling/RequestFixture.html#pathBinding-java.util.Map-" class="bare">http://ratpack.io/manual/current/api/ratpack/test/handling/RequestFixture.html#pathBinding-java.util.Map-</a></p>
</li>
<li>
<p><a href="http://ratpack.io/manual/current/api/ratpack/test/handling/HandlingResult.html#rendered-java.lang.Class-" class="bare">http://ratpack.io/manual/current/api/ratpack/test/handling/HandlingResult.html#rendered-java.lang.Class-</a></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_functional_testing">4.2. Functional testing</h3>
<div class="paragraph">
<p>Functional testing in the context of a Ratpack app means to spin up a server instance, use an HTTP client to send requests and set assertions on the response received.</p>
</div>
<div class="paragraph">
<p>To make Ratpack start the application your tests, and to get an HTTP client, you can define the following attributes in your specification class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">@Shared ApplicationUnderTest aut = new GroovyRatpackMainApplicationUnderTest()
@Delegate TestHttpClient testClient = aut.httpClient</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that by using Groovy&#8217;s <code>@Delegate</code> annotation, all the methods of the <a href="http://ratpack.io/manual/current/api/ratpack/http/client/HttpClient.html">HTTP Client</a> are available in your specification.</p>
</div>
<div class="paragraph">
<p>For this exercise, write a Spock specification (<code>ApplicationSpec</code>) that tests all the handlers defined in the chain DSL (<code>Ratpack.groovy</code>).</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<a href="http://ratpack.io/manual/current/testing.html#functional_testing" class="bare">http://ratpack.io/manual/current/testing.html#functional_testing</a>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_working_with_the_context_20_minutes">5. Working with the context (20 minutes)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The context is a place where handlers can register objects so that other handlers can get them in a later stage in the chain.</p>
</div>
<div class="paragraph">
<p>To build a <a href="http://ratpack.io/manual/current/api/ratpack/registry/Registry.html"><code>Registry</code></a>, you can use the methods in the <a href="http://ratpack.io/manual/current/api/ratpack/registry/Registries.html"><code>Registries</code></a> class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">handler {
    //Builds a registry builder and adds 2 objects to it
    Registry registry = Registries.registry().add(MyService, new MyServiceImpl()).add('String instance').build()
    next(registry)
}

handler('foo') {
    assert context.get(MyService) instanceof MyServiceImpl
    assert context.get(String) == 'String instance'
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Sometimes you just need to pass a single object to downstream handlers. Note also that alternatively, you can get access registry object by defining them as the closure argument of the handler:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">handler {
    String token = request.headers.get('X-Auth-Token')
    next(just(token))
}

handler('foo') {
    String token = context.get(String)
    doWhatEver(token)
}

handler('bar') { String token -&gt;
    doWhatEver(token)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For this exercise, write the necessary handler chain in <code>Ratpack.groovy</code> to make all the tests pass.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p><a href="http://ratpack.io/manual/current/context.html#contextual_objects" class="bare">http://ratpack.io/manual/current/context.html#contextual_objects</a></p>
</li>
<li>
<p><a href="http://ratpack.io/manual/current/api/ratpack/registry/Registry.html" class="bare">http://ratpack.io/manual/current/api/ratpack/registry/Registry.html</a></p>
</li>
<li>
<p><a href="http://ratpack.io/manual/current/api/ratpack/registry/Registries.html#just-java.lang.Object-" class="bare">http://ratpack.io/manual/current/api/ratpack/registry/Registries.html#just-java.lang.Object-</a></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_ratpack_modules_with_google_guice_20_minutes">6. Using Ratpack modules with Google Guice (20 minutes)</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>ratpack-jackson-guice</code> library was removed from <a href="http://ratpack.io/versions/1.0.0-rc-1">1.0.0 RC-1</a> onwards and the functionality is now part of <code>ratpack-core</code>. This exercise probably needs an update to use a current Ratpack module.
However, this is a good exercise for JSON handling.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As an optional feature, Ratpack offers you the possibility to enhance your application by using modules powered by Guice.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/google/guice">Google Guice</a> is a dependency injection framework built by Google that allows you to decouple the components of your application by making them reusable parts. Ratpack also offers to you ready to use modules, such as Jackson, H2, Codahale Metrics, Handlebars, etc.</p>
</div>
<div class="paragraph">
<p>When using Gradle and the Ratpack Gradle plugin, adding a "supported" module is as easy as:</p>
</div>
<div class="listingblock">
<div class="title"><code>build.gradle</code></div>
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">...
dependencies {
  compile ratpack.dependency("jackson")
}
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then, you have to add the Jackson module to the binding:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">ratpack {

  bindings {
    add new JacksonModule()
  }

  handlers {
    ...
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>With the Jackson module, you can benefit from the different ways of reading and writing JSON thanks to the static methods of the <a href="http://ratpack.io/manual/current/api/ratpack/jackson/Jackson.html"><code>Jackson</code></a> class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-groovy" data-lang="groovy">handler {
  render(Jackson.json(foo: 'bar')) // Yields {"foo":"bar"}
}</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_rendering_json_with_jackson">6.1. Rendering JSON with Jackson</h3>
<div class="paragraph">
<p>Now the tests have been updated to expect a JSON response when <code>/api/:username</code> endpoint is called. Make the necessary changes to the application to make the test pass.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p><a href="http://ratpack.io/manual/current/jackson.html#jackson" class="bare">http://ratpack.io/manual/current/jackson.html#jackson</a></p>
</li>
<li>
<p><a href="http://ratpack.io/manual/current/api/ratpack/jackson/Jackson.html#rendering" class="bare">http://ratpack.io/manual/current/api/ratpack/jackson/Jackson.html#rendering</a></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2015-11-25 13:44:05 CET
</div>
</div>
</body>
</html>